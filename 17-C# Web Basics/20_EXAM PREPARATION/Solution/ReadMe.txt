There are some small problems in the solution. I will fix them when i have more free time.